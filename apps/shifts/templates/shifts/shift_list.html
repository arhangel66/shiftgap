{% extends "__base.html" %}
{% load tz %}

{% block head %}
{% endblock head %}

{% block content %}
    <style>
        .brown{color:#56242d; font-size:12px; font-weight: bold;white-space:nowrap;}
        .b-shift{background-color:#cdd3af; font-size:10px; color:#7a795b; border:1px solid #7a795b}
        .b-shift__head{white-space:nowrap; background-color: #b7bf8e}
        .b-shift_body{white-space:nowrap;}
        .b-body-text {padding:2px}
        .b-head-text {padding:2px}
    </style>
    <div class="container-fluid">
    <div class="col-md-10">
    <h2>Upcoming Shifts</h2>
        <table cellpadding="0" cellspacing="0" border="0" class="table table-striped table-bordered table-filter">
        {% for line in table %}
            {% if forloop.first %}
                <thead>
                    {% for cell in line %}
                        <th class="brown">{% if cell %}{{ cell }}{% endif %}</th>
                    {% endfor %}
                </thead>
            {% else %}
            <tr>
            {% for cell in line %}
                <td>
                    {% if forloop.first %}
                        {% autoescape off %}{{ cell.show }}{% endautoescape %}
                    {% else %}
                        {% for zn in cell %}
                            {% autoescape off %}{{ zn.show }}{% endautoescape %}<br>
                        {% endfor %}
                    {% endif %}
                </td>
            {% endfor %}
            </tr>
            {% endif %}
        {% endfor %}
        </table>
{#        {% for object in object_list %}#}
{#            {{ object.employee }}#}
{#        {% localtime off %}#}
{#        Start Time UTC: {{ object.start_time }} - End Time UTC: {{ object.end_time }}#}
{#        {% endlocaltime %}#}
{#        <br />#}
{#        {% localtime on %}#}
{#        Start Time Local: {{ object.start_time }} - End Time Local: {{ object.end_time }}#}
{#        {% endlocaltime %}#}
{#        <hr>#}
{#    {% endfor %}#}

    </div>
    <div class="col-md-2">
        <form action="" method="POST">
            {% csrf_token %}
            <input name="employee_name" id="id_employee_name" placeholder="Enter employee's name..." />
        </form>
    </div>

    </div>



    <!-- bye bye modal
    Button trigger modal
    <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#addShiftModal">
        Add Shift
    </button>

     Modal
    <div class="modal fade" id="addShiftModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title" id="myModalLabel">Add a New Shift</h4>
                </div>
                <form action="" method="post">
                <div class="modal-body">

                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                    <input type="submit" value="Add Shift" class="btn btn-primary">
                    </form>
                </div>
            </div>
        </div>
    </div>
    <-->
<!-- Button trigger modal -->
<button type="button" class="btn btn-primary btn-lg load_page" data-toggle="modal" data-target="#myModal" load_page="{% url 'shifts:shift_create' %}" title="new shift">
  new shift
</button>

<!-- Modal -->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="myModalLabel">Modal title</h4>
      </div>
      <div class="modal-body">
<div class="alert alert-success">
  <a href="#" class="alert-link">...</a>
</div>
      </div>
    </div>
  </div>
</div>

{% endblock content %}

{% block after %}
<script type="text/javascript">
$().ready(function() {
    $("body").delegate(".load_page", "click", function() {
            var $modal_body = $('div.modal-body');
            var $modal_title = $('h4.modal-title');
            var url = $(this).attr('load_page');
            $.get(url,
                function(data) {
                    $modal_title.html($(this).attr('title'));
                    $modal_body.html(data);
                })
        })

    $("div.modal").delegate("form#shift_form", "submit", function() {

       var inp_date = $('#shift_form').serialize();
        url = "{% url 'shifts:shift_create' %}"
        $.post(url, inp_date,
                function(data) {
                    if (data.status == true) {
                        $('div.modal .alert-success').show();
                        $('div.modal .alert-body-success').html(data.message);
                    }
                    else {
                        $('div.modal .alert-danger').show();
                        $('div.modal .alert-body-danger').html(data.message);
                    }
                }, 'json');

        return false
    })

})
</script>
{% endblock after %}